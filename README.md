# Support Assistant

–ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞ –±–∞–∑–µ LLM —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ RAG.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- ü§ñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LLM:
  - Perplexity API (–º–æ–¥–µ–ª—å sonar-pro) - –æ–±–ª–∞—á–Ω–∞—è –º–æ–¥–µ–ª—å
  - –õ–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ Ollama (qwen3:8b, llama3, mistral –∏ –¥—Ä.)
- üîß –ü–æ–¥–¥–µ—Ä–∂–∫–∞ MCP (Model Context Protocol) –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- üìö RAG —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- üé´ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ticketManager/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ mcp_config.yaml        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MCP —Å–µ—Ä–≤–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ api_keys.yaml          # API –∫–ª—é—á–∏
‚îÇ   ‚îî‚îÄ‚îÄ local_llm_config.yaml  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π LLM
‚îú‚îÄ‚îÄ docs/                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è RAG
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ embeddings.json        # –ò–Ω–¥–µ–∫—Å —ç–º–±–µ–¥–∏–Ω–≥–æ–≤
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ llm_client.py          # –ö–ª–∏–µ–Ω—Ç—ã LLM (Perplexity + –ª–æ–∫–∞–ª—å–Ω—ã–µ)
‚îÇ   ‚îú‚îÄ‚îÄ mcp_handler.py         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ MCP
‚îÇ   ‚îú‚îÄ‚îÄ rag/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ indexer.py         # –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ embeddings.py      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–∏–Ω–≥–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ retriever.py       # –ü–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ prompts/
‚îÇ       ‚îî‚îÄ‚îÄ system_prompt.py   # –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install -r requirements.txt
```

3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
   - –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä LLM –≤ `config/api_keys.yaml` (`llm_provider: "perplexity"` –∏–ª–∏ `"local"`)
   - –î–ª—è Perplexity: –¥–æ–±–∞–≤—å—Ç–µ API –∫–ª—é—á –≤ `config/api_keys.yaml`
   - –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ `config/local_llm_config.yaml`
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ MCP —Å–µ—Ä–≤–µ—Ä—ã –≤ `config/mcp_config.yaml`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤–º–µ—Å—Ç–æ Perplexity:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama:
```bash
# macOS
brew install ollama

# Linux
curl -fsSL https://ollama.ai/install.sh | sh
```

2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –º–æ–¥–µ–ª—å:
```bash
ollama run qwen3:8b
```

3. –ò–∑–º–µ–Ω–∏—Ç–µ –≤ `config/api_keys.yaml`:
```yaml
llm_provider: "local"
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [docs/local_llm_setup.md](docs/local_llm_setup.md)

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫

```bash
cd src
python main.py
```

### –ö–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/index` | –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ –ø–∞–ø–∫–∏ `docs/` |
| `/clear` | –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞ |
| `/status <id>` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ç–∏–∫–µ—Ç–∞ |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º |
| `/exit` | –í—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã |

### –†–∞–±–æ—Ç–∞ —Å RAG

1. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ –ø–∞–ø–∫—É `docs/` (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è `.txt`, `.md`)
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –∫–æ–º–∞–Ω–¥–æ–π `/index`
3. –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–∞—Ç—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–∏ –æ—Ç–≤–µ—Ç–∞—Ö

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### LLM Client
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–≤—É—Ö —Ç–∏–ø–æ–≤ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤:
- **PerplexityClient**: –û–±–ª–∞—á–Ω–∞—è –º–æ–¥–µ–ª—å sonar-pro —á–µ—Ä–µ–∑ API
- **LocalLLMClient**: –õ–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ Ollama (qwen3:8b, llama3, mistral –∏ –¥—Ä.)

–û–±–∞ –∫–ª–∏–µ–Ω—Ç–∞ —Ä–µ–∞–ª–∏–∑—É—é—Ç –æ–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `BaseLLMClient` –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω—ã —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.

### MCP Handler
–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–∑–æ–≤–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ LLM:
- `create_ticket` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞
- `search_knowledge_base` - –ø–æ–∏—Å–∫ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- `get_ticket_status` - —Å—Ç–∞—Ç—É—Å —Ç–∏–∫–µ—Ç–∞

### RAG Pipeline
1. **Indexer**: –†–∞–∑–±–∏–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ —á–∞–Ω–∫–∏ (500 —Å–∏–º–≤–æ–ª–æ–≤, –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ 50)
2. **Embeddings**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—É—é LLM
3. **Retriever**: –ü–æ–∏—Å–∫ –ø–æ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–º—É —Å—Ö–æ–¥—Å—Ç–≤—É (—Ç–æ–ø-3 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞)

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.9+
- **–î–ª—è Perplexity**: API –∫–ª—é—á (–ø–æ–ª—É—á–∏—Ç—å –Ω–∞ https://www.perplexity.ai/settings/api)
- **–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏**: Ollama + –º–æ–¥–µ–ª—å qwen3:8b (–∏–ª–∏ –¥—Ä—É–≥–∞—è)
- –õ–æ–∫–∞–ª—å–Ω–∞—è LLM –¥–ª—è —ç–º–±–µ–¥–∏–Ω–≥–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Ollama —Å `mxbai-embed-large`)
- MCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∏–∫–µ—Ç–∞–º–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π LLM](docs/local_llm_setup.md) - –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- [–ü—Ä–∏–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](docs/example.md) - –ø—Ä–∏–º–µ—Ä –¥–ª—è RAG —Å–∏—Å—Ç–µ–º—ã

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
